$(document).ready(function(){$(document).bind("dragstart",function(){return!1});var e={start_interaction:{id:6260200,onEvent:!1},arrive_station3:{id:6260201,onEvent:!1},arrive_station4:{id:6260202,onEvent:function(){setPoster("assets/img/poster.jpg")}},arrive_station6:{id:6260203,onEvent:!1},arrive_station7:{id:6260204,onEvent:function(){$("#parallax").parallaxSwipe.setEdge("right")}},leave_station3:{id:6260205,onEvent:!1},leave_station4:{id:6260206,onEvent:!1},leave_station6:{id:6260207,onEvent:!1},leave_station7:{id:6260208,onEvent:!1},click_lise:{id:6260209,onEvent:!1},click_farmer:{id:6260210,onEvent:!1},close_lise:{id:6260213,onEvent:!1},close_farmer:{id:6260214,onEvent:!1},click_link1:{id:6260211,onEvent:function(){console.log("Opening link1")}},click_link2:{id:6260212,onEvent:function(){console.log("Opening link2")}},video_play:{id:6260215,onEvent:!1},video_pause:{id:6260216,onEvent:!1},video_finish:{id:6260220,onEvent:!1}},t=!1,n=({start:(new Date).getTime()},!1),i=null,r=!0;$(function(){window.onerror=function(e,t,n){var i="JS error: "+e+" @ "+t+":"+n;i+="url: "+document.URL;var r=new UserAgent;return i+="browser: "+r.browser_name+" "+r.browser_version+" | OS: "+r.os+" | platform: "+r.platform,a(i,e),!1};var o=function(e){e=e},a=function(e,t){t?console.log(e,t):console.log(e),r&&$("#log").append('<li class="line"><pre><code>'+e+"</code></pre></li>"),o(e,t)},s=function(e,t,n,i){var e=e||"bounce",t=t||5e3,n=n||!1,i=i||!1;u()||(c(e,n,i),n&&setTimeout(s,t,e,t,n,i))},l=function(e){var e=e||!1;e&&car.classList.remove(e)},c=function(e,t,n){var e=e||"bounce",n=n||!1;car.classList.add(e),n&&setTimeout(l,n,e)},d=function(){n=!0},u=function(){return n},f=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},p=function(e){f()?(console.log("Opening link the android way: "+e.href),window.open(e.href)):(console.log("Opening link the fake-click way: "+e.href),h(null,e))},g=function(n){var i=e[n.event]||!1,o="function"==typeof p62602Event?p62602Event:!1;if(n.registered=!1,v(n.event),!o)return t=!0,n.registered=!1,M.push(n),console.log("Analytics script not loaded, buffering event: "+n.event),void 0;if(t){for(var s=0,l=M.length;l>s;s++)console.log("registering delayed event: "+M[s].event+" ("+e[M[s].event].id+")"),setTimeout(o(e[M[s].event].id),200),M[s].registered=!0;t=!1}if(r)return a("[EVENT] "+n.event),void 0;try{if(!e[n.event])return console.log("Unknown event : "+n.event),void 0;o(i.id),"function"==typeof i.onEvent&&i.onEvent.call()}catch(i){a("Exception in function onEvent()",i)}n.registered=!0,M.push(n)},v=function(e){for(var e=e||!1,t=0,n=ONDEMAND_LOADERS.length;n>t;t++)e===ONDEMAND_LOADERS[t].getAttribute("data-load-event")&&ONDEMAND_LOADERS[t].classList.add(ONDEMAND_LOADERS[t].id)},m=function(){if(u())return console.log("Already initialized, escaping"),void 0;q=document.getElementsByClassName("lazyload"),ONDEMAND_LOADERS=document.getElementsByClassName("lazyload ondemand");for(var e=0,t=q.length;t>e;e++)q[e].classList.contains("ondemand")||q[e].classList.add(q[e].id);d(!0);var n={event:"start_interaction",message:"First swipe detected.",target:null,time:(new Date).getTime()};g(n)},E=function(e){var t=document.getElementById(e||"video1");return t?i||!1!==(i=w(t))?(i.togglePause(),!0):!1:!1},w=function(e){try{var t="string"==typeof e?document.getElementById(e):e,n={},i=!1;t.addEventListener("loadedmetadata",function(){this.loadedMetaData=!0},!1),t.addEventListener("error",function(e){logError(e)},!1),t.addEventListener("play",function(){g({event:"video_play"})},!1),t.addEventListener("pause",function(){g({event:"video_stop"})},!1),t.addEventListener("ended",function(){g({event:"video_finished"})},!1),n.element=t,n.play=function(){t.play()},n.pause=function(){t.pause()},n.stop=function(){t.playing&&t.pause()},n.togglePause=function(){t.paused?t.play():t.pause()},n.skip=function(e){t.currentTime+=e},n.reset=function(){i&&(t.currentTime=0)},n.restart=function(){i&&(t.currentTime=0,g({event:"video_restart"}))},n.toggleControls=function(){t.hasAttribute("controls")?this.hideControls():this.showControls()},n.showControls=function(){t.setAttribute("controls","controls")},n.hideControls=function(){t.removeAttribute("controls")},n.setPoster=function(e){t.setAttribute("poster",e)}}catch(r){throw n=null,r}return n},h=({req:new XMLHttpRequest,__execute:function(){this.req||XMLHttpRequest()},send:function(e,t){this.__execute(e,t)},updateProgress:function(e){e.lengthComputable&&e.loaded/e.total},transferComplete:function(){console.log("The transfer is complete.")},transferFailed:function(){console.log("An error occurred while transferring the file.")},transferCanceled:function(){console.log("The transfer has been canceled by the user.")},loadEnd:function(){console.log("The transfer finished (although we don't know if it succeeded or not).")},init:function(){req.addEventListener("progress",updateProgress,!1),req.addEventListener("load",transferComplete,!1),req.addEventListener("loadend",loadEnd,!1),req.addEventListener("error",transferFailed,!1),req.addEventListener("abort",transferCanceled,!1)},getHeaderTime:function(){return this.getResponseHeader("Last-Modified")}},function(e,t){if(console.log("Faking a click"),t.click)t.click();else if(document.createEvent&&e.target!==t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}),_=function(e){var t=Math.abs(e.offsetLeft+P)+e.clientX;if(R&&H(),W&&z(),t>=4886&&5011>=t){if(e.clientY>230&&275>e.clientY)return}else if(t>=6480&&6605>=t){if(e.clientY>240&&285>e.clientY)return H(),void 0}else if(t>=7824&&8052>=t){if(e.clientY>230&&282>e.clientY)return p(link1),g({event:"click_link1"}),void 0;if(e.clientY>286&&332>e.clientY)return p(link2),g({event:"click_link2"}),void 0}else if(t>=3137&&3553>=t&&e.clientY>86&&322>e.clientY)return console.log("click on video: "+link2.href),E(),void 0;return!1},y=function(e){_(e)},k=null,b=!1,x=!1,L={},I="none",P=0,S=0,A=100,D=400,C=.9,B=.9,O=.9,R=!1,W=!1,N=60,T=[],M=[],q=null;ONDEMAND_LOADERS=null,i=null,CLICK_ENABLED=!1,car=document.getElementById("car"),debugpanel=document.getElementById("debugoutput"),parallax=document.getElementById("parallax"),scene=document.getElementById("layer5"),debuginfo=document.getElementById("debuginfo"),lise_recipe=document.getElementById("lise_recipe"),lise_hello=document.getElementById("lise_hello"),farmer_recipe=document.getElementById("farmer_recipe"),farmer_hello=document.getElementById("farmer_hello"),final_btn1=document.getElementById("final_btn1"),final_btn2=document.getElementById("final_btn2"),link1=document.getElementById("link1"),link2=document.getElementById("link2"),clicktargets={};for(var Y=document.getElementsByClassName("clicktarget"),X=0,F=Y.length;F>X;X++){clicktargets[Y[X].id]={element:Y[X],rect:Y[X].getBoundingClientRect()};var U=clicktargets[Y[X].id];console.log("clickTarget   : "+U.element.id+"(<"+U.element.nodeName.toLowerCase()+">)"+" @ "+U.rect.left+", "+U.rect.top+" ("+U.rect.right+", "+U.rect.bottom+")")}var H=function(){R?(g({event:"close_lise"}),$("#lise_tips").animate({top:40,opacity:1},325,"linear"),$("#lise_recipe").animate({top:-500,opacity:0},325,"linear")):(g({event:"click_lise"}),$("#lise_tips").animate({top:500,opacity:0},325,"linear"),$("#lise_recipe").animate({top:0,opacity:1},325,"linear")),R=!R},z=function(){W?(g({event:"click_farmer"}),$("#farmer_tips").animate({top:40,opacity:1},325,"linear"),$("#farmer_recipe").animate({top:-500,opacity:0},325,"linear")):(g({event:"click_farmer"}),$("#farmer_tips").animate({top:500,opacity:0},325,"linear"),$("#farmer_recipe").animate({top:0,opacity:1},325,"linear")),W=!W},K=function(){var e,t=(new Date).getTime(),n=parallax.getBoundingClientRect();if(x||(b=""+new Date,x=(new Date).getTime(),starttimetext=""+(new Date).getTime()),n){S=P-n.left,S>N&&(u()||(m(),console.log("Interaction detected, preloading resources ..")));var i=0,r=3;for(var o in L)if(!(r>++i)){if(e=P-(L[o].getBoundingClientRect().left-D),0>e)break;if(T[o]||(T[o]=!0),Math.abs(e)>D+250){if(I===o){$("#parallax").parallaxSwipe.setSpeed(C,B,O);var a={event:"leave_"+o,message:"leaving station "+o,target:I,time:t};g(a),I="none"}}else if(I!==o){g({event:"arrive_"+o,message:"arriving at station "+o,target:I,time:t}),I=o;var s=Math.round($("#"+I).position().left);console.log("Requesting position of "+I+" at "+s+", offset: "+$("#"+I).offset().left+", position: "+$("#"+I).position().left+", startpos: "+P),$("#parallax").parallaxSwipe.requestPosition(-s)}}}},V=function(){var e=L.length;P=parallax.getBoundingClientRect().left,e||($(".station").each(function(e,t){L[t.id||e]=t}),e=L.length),k=setInterval(K,A),s("bounce",8e3,!0,3e3)};setTimeout(function(){window.scrollTo(0,1)},0),$("#parallax").parallaxSwipe({DECAY:B,MOUSEDOWN_DECAY:O,SPEED_SPRING:C,BOUNCE_SPRING:.5,HORIZ:!0,SNAPDISTANCE:20,DISABLELINKS:!1,LAYER:[20,12,3.2,1.6,1,1]});var G=$("#parallax").parallaxSwipe.getSize();$(".parallax_layer").css("width",G),$("#parallax").bind("click",function(e){var t={offsetLeft:e.target.offsetLeft,offsetTop:e.target.offsetTop};return"number"==typeof t.offsetLeft&&(t.clientX=e.clientX,t.clientY=e.clientY),y(t),!0}),$(".recipe").bind("selectstart",function(){return!1}),V()})});var UserAgent;UserAgent=function(){function e(e){null==e&&(e=navigator.userAgent),this.source=e.replace(/^\s*/,"").replace(/\s*$/,""),this.browser_name=o(this.source),this.browser_version=a(this.source),this.os=s(this.source),this.platform=l(this.source)}var t,n,i,r,o,a,s,l;return r={Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i},t={Konqueror:/konqueror/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie/i,Opera:/opera/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i},n={WindowsVista:/windows nt 6\.0/i,Windows7:/windows nt 6\.1/i,Windows8:/windows nt 6\.2/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,OSX:/os x (\d+)[._](\d+)/i,Linux:/linux/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Ipad:/\(iPad.*os (\d+)[._](\d+)/i,Iphone:/\(iPhone.*os (\d+)[._](\d+)/i},i={Windows:/windows/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,Ipad:/ipad/i,Ipod:/ipod/i,Iphone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i},o=function(e){switch(!0){case t.Konqueror.test(e):return"konqueror";case t.Chrome.test(e):return"chrome";case t.Safari.test(e):return"safari";case t.IE.test(e):return"ie";case t.Opera.test(e):return"opera";case t.PS3.test(e):return"ps3";case t.PSP.test(e):return"psp";case t.Firefox.test(e):return"firefox";default:return"unknown"}},a=function(e){var t;switch(o(e)){case"chrome":if(r.Chrome.test(e))return RegExp.$1;break;case"safari":if(r.Safari.test(e))return RegExp.$1;break;case"firefox":if(r.Firefox.test(e))return RegExp.$1;break;case"ie":if(r.IE.test(e))return RegExp.$1;break;case"ps3":if(r.Ps3.test(e))return RegExp.$1;break;case"psp":if(r.Psp.test(e))return RegExp.$1;break;default:if(t=/#{name}[\/ ]([\d\w\.\-]+)/i,t.test(e))return RegExp.$1}},s=function(e){switch(!0){case n.WindowsVista.test(e):return"Windows Vista";case n.Windows7.test(e):return"Windows 7";case n.Windows2003.test(e):return"Windows 2003";case n.WindowsXP.test(e):return"Windows XP";case n.Windows2000.test(e):return"Windows 2000";case n.Linux.test(e):return"Linux";case n.Wii.test(e):return"Wii";case n.PS3.test(e):return"Playstation";case n.PSP.test(e):return"Playstation";case n.OSX.test(e):return e.match(n.OSX)[0].replace("_",".");case n.Ipad.test(e):return e.match(n.Ipad)[0].replace("_",".");case n.Iphone.test(e):return e.match(n.Iphone)[0].replace("_",".");default:return"unknown"}},l=function(e){switch(!0){case i.Windows.test(e):return"Microsoft Windows";case i.Mac.test(e):return"Apple Mac";case i.Android.test(e):return"Android";case i.Blackberry.test(e):return"Blackberry";case i.Linux.test(e):return"Linux";case i.Wii.test(e):return"Wii";case i.Playstation.test(e):return"Playstation";case i.Ipad.test(e):return"iPad";case i.Ipod.test(e):return"iPod";case i.Iphone.test(e):return"iPhone";default:return"unknown"}},e}();