var UserAgent;UserAgent=function(){function e(e){null==e&&(e=navigator.userAgent),this.source=e.replace(/^\s*/,"").replace(/\s*$/,""),this.browser_name=o(this.source),this.browser_version=r(this.source),this.os=a(this.source),this.platform=c(this.source)}var t,n,i,s,o,r,a,c;return s={Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i},t={Konqueror:/konqueror/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie/i,Opera:/opera/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i},n={WindowsVista:/windows nt 6\.0/i,Windows7:/windows nt 6\.1/i,Windows8:/windows nt 6\.2/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,OSX:/os x (\d+)[._](\d+)/i,Linux:/linux/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Ipad:/\(iPad.*os (\d+)[._](\d+)/i,Iphone:/\(iPhone.*os (\d+)[._](\d+)/i},i={Windows:/windows/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,Ipad:/ipad/i,Ipod:/ipod/i,Iphone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i},o=function(e){switch(!0){case t.Konqueror.test(e):return"konqueror";case t.Chrome.test(e):return"chrome";case t.Safari.test(e):return"safari";case t.IE.test(e):return"ie";case t.Opera.test(e):return"opera";case t.PS3.test(e):return"ps3";case t.PSP.test(e):return"psp";case t.Firefox.test(e):return"firefox";default:return"unknown"}},r=function(e){var t;switch(o(e)){case"chrome":if(s.Chrome.test(e))return RegExp.$1;break;case"safari":if(s.Safari.test(e))return RegExp.$1;break;case"firefox":if(s.Firefox.test(e))return RegExp.$1;break;case"ie":if(s.IE.test(e))return RegExp.$1;break;case"ps3":if(s.Ps3.test(e))return RegExp.$1;break;case"psp":if(s.Psp.test(e))return RegExp.$1;break;default:if(t=/#{name}[\/ ]([\d\w\.\-]+)/i,t.test(e))return RegExp.$1}},a=function(e){switch(!0){case n.WindowsVista.test(e):return"Windows Vista";case n.Windows7.test(e):return"Windows 7";case n.Windows2003.test(e):return"Windows 2003";case n.WindowsXP.test(e):return"Windows XP";case n.Windows2000.test(e):return"Windows 2000";case n.Linux.test(e):return"Linux";case n.Wii.test(e):return"Wii";case n.PS3.test(e):return"Playstation";case n.PSP.test(e):return"Playstation";case n.OSX.test(e):return e.match(n.OSX)[0].replace("_",".");case n.Ipad.test(e):return e.match(n.Ipad)[0].replace("_",".");case n.Iphone.test(e):return e.match(n.Iphone)[0].replace("_",".");default:return"unknown"}},c=function(e){switch(!0){case i.Windows.test(e):return"Microsoft Windows";case i.Mac.test(e):return"Apple Mac";case i.Android.test(e):return"Android";case i.Blackberry.test(e):return"Blackberry";case i.Linux.test(e):return"Linux";case i.Wii.test(e):return"Wii";case i.Playstation.test(e):return"Playstation";case i.Ipad.test(e):return"iPad";case i.Ipod.test(e):return"iPod";case i.Iphone.test(e):return"iPhone";default:return"unknown"}},e}();var OPTIONS={FORMAT:"json",METHOD:"post",SERVER:"http://kromaviews.no:8080/dev/games/bama/srv/kroma.debug.logger.php"},CLIENT={url:window.location,event:"unknown",userAgent:UserAgent(),timestamp:0,description:""};HTMLDebugger=function(e){var t={__console:document.getElementById("console")||!1,_options:{},SESSION:{start:(new Date).getTime(),initialized:!1,EVENTS:[],IS_IDLE:!1,IS_VISIBLE:!1,TIME:{total:0,idle:0,active:0,visible:0,hidden:0}}};return t.__onWindowMessage=function(e){HTMLDebugger.log(e.origin+" posted message: "+e.data)},t.__onIdleStart=function(){HTMLDebugger.SESSION.IS_IDLE=!0},t.__onIdleEnd=function(){HTMLDebugger.SESSION.IS_IDLE=!1},t.__onVisible=function(){HTMLDebugger.SESSION.IS_VISIBLE=!0},t.__onHidden=function(){HTMLDebugger.SESSION.IS_VISIBLE=!1},t.__onTimer=function(){HTMLDebugger.SESSION.TIME.total++,HTMLDebugger.SESSION.IS_VISIBLE?HTMLDebugger.SESSION.TIME.visible++:HTMLDebugger.SESSION.TIME.hidden++,HTMLDebugger.SESSION.IS_IDLE?HTMLDebugger.SESSION.TIME.idle++:HTMLDebugger.SESSION.TIME.active++},t.__init=function(e){this.SESSION.info={animationMethod:this.getAnimationMethod(),url:window.location},this.SESSION.initialized=!0,document.addEventListener("message",this.__onWindowMessage,!1),this._timer=setInterval(this.__onTimer,1e3);for(var n in e)t._options[n]=e[n];return t._img=new Image,!0},t._sendJSON=function(e){var t=new XMLHttpRequest,n=JSON.stringify(e);return 0===e.length?(console.log("NOT sending empty data object to logging server."),!1):(t.onload=this._onResponse,t.open("POST",this._options.SERVER,!0),t.setRequestHeader("Content-type","application/json; charset=utf-8"),t.setRequestHeader("Content-length",n.length),t.setRequestHeader("Connection","close"),t.send(n),void 0)},t.getAnimationMethod=function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};return e.name||e},t._sessionTime=function(){return this.START_SESSION-(new Date).getTime()},t._sendREQUEST=function(e){var t=this._encodeAsGet(e);console.log("Sending GET request: "+this._options.SERVER+"?"+t),this._img.src=this._options.SERVER+"?"+t},t._send=function(e,t){var t=t||this._options.METHOD;if("object"!=typeof e)return console.log("Wrong parameter type '"+typeof e+"', expected an object."),!1;if(0===e.length)return console.log("NOT sending empty data object to logging server."),!1;switch(t.toLowerCase()){case"json":this._sendJSON(e);break;case"get":this._sendREQUEST(e);break;default:this._sendJSON(e)}},t.DebugEvent=function(e,t,n){var i={event:e||CLIENT.event,timestamp:(new Date).getTime(),description:t||CLIENT.description,data:n||!1};for(var s in CLIENT)void 0===i[s]&&(i[s]=CLIENT[s]);return i},t._encodeAsGet=function(e,t){var n={},t=t||"";""!==t&&(t+="_");for(var i in e)"object"==typeof e[i]?(t+=i,n=this._encodeAsGet(e[i],t+i)):n[t+i]=encodeURIComponent(e[i]);return n},t._onResponse=function(){if(4==this.readyState){if(200!=this.status&&304!=this.status)return t.log("HTTP error: "+this.status+" - "+this.statusText),void 0;var e=JSON.parse(this.responseText);1==e.OK||console.log("Error-response received from logger service: "+this.status+" - "+e.OK,e)}},t._onError=function(e){var t="string"==typeof e.message?e.message:!1;t&&(t+="\n"+e.fileName||"",t+=":",t+=e.lineNumber||"",t+=" - "),DEBUG&&(t+=HTMLDebugger.stacktrace(e)),this.error(t,e)},t._logToConsole=function(e,t){return this.__console?(console.log("console.nodeName: "+this.__console.nodeName),console.log("console.nodeType: "+this.__console.nodeType),this.__console.value+=e+(t?JSON.stringify(t):"")):console.log("No __console element!"),window.console?void 0:(t?console.log(e,t):console.log(e),!0)},t.setSessionVariable=function(e,t,n){var n="string"==typeof n&&n.length>0?n:!1;n?(this.SESSION[n]||(this.SESSION[n]={}),this.SESSION[n][e]=t):this.SESSION[e]=t},t.error=function(e,t){this._send({event:"error",message:e,data:t||!1})},t.log=function(e,t){this._send({event:"log",message:e,data:t||!1})},t.send=function(e){this._send({event:"data",data:e||null})},t.stacktrace=function(e){return e.stack||"No stack trace available."},window.onerror=this._onError,console.log("Starting KROMA HTMLDebugger."),t.__init(e),t}(OPTIONS);var Histogram=Histogram||void 0;