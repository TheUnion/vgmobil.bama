$(document).ready(function(){var e=!1,t={start_interaction:{id:6260100,onEvent:!1},arrive_station3:{id:6260101,onEvent:!1},arrive_station3:{id:6260102,onEvent:function(e){e("assets/img/poster.jpg")}},arrive_station6:{id:6260103,onEvent:!1},arrive_station7:{id:6260104,onEvent:function(){$("#parallax").parallaxSwipe.setEdge("right")}},leave_station3:{id:6260105,onEvent:!1},leave_station4:{id:6260106,onEvent:!1},leave_station6:{id:6260107,onEvent:!1},leave_station7:{id:6260108,onEvent:!1},click_lise:{id:6260109,onEvent:!1},click_farmer:{id:6260110,onEvent:!1},close_lise:{id:6260113,onEvent:!1},close_farmer:{id:6260114,onEvent:!1},click_link1:{id:6260111,onEvent:function(){console.log("Opening link1")}},click_link2:{id:6260112,onEvent:function(){console.log("Opening link2")}},video_play:{id:6260115,onEvent:!1},video_pause:{id:6260116,onEvent:!1},video_finish:{id:6260120,onEvent:!1}},n=!1;e&&(requireScript("../../assets/js/lib/kroma.debugger.js?cb="+Math.round(1e5*Math.random()),!1,!1,function(){console.log("loaded: "+this.url)},function(){console.log("Error loading: "+this.url)}),requireScript("../../assets/js/lib/idle.js?cb="+Math.round(1e5*Math.random()),!1,!1,function(){console.log("loaded: "+this.url)},function(){console.log("Error loading: "+this.url)})),$(document).bind("dragstart",function(){return!1}),$(function(){var i,o=function(t,n){n?console.log(t,n):console.log(t),e&&($("#log").append('<li class="line"><pre><code>'+t+"</code></pre></li>"),"object"==typeof HTMLDebugger&&HTMLDebugger.send(t,n?JSON.stringify(n):null))},r=function(e,t,n,i){var e=e||"bounce",t=t||5e3,n=n||!1,i=i||!1;l()||(s(e,n,i),n&&setTimeout(r,t,e,t,n,i))},a=function(e){var e=e||!1;e&&j.classList.remove(e)},s=function(e,t,n){var e=e||"bounce",n=n||!1;j.classList.add(e),n&&setTimeout(a,n,e)},c=function(){n=!0},l=function(){return n},u=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},d=function(e){u()?(console.log("Opening link the android way: "+e.href),window.open(e.href)):(console.log("Opening link the fake-click way: "+e.href),h(null,e))},f=function(n){var i=t[n.event]||!1,r="function"==typeof p62601Event?p62601Event:!1;if(n.registered=!1,p(n.event),!r)return X=!0,n.registered=!1,Y.push(n),console.log("Analytics script not loaded, buffering event: "+n.event),void 0;if(e)return o("[EVENT] "+n.event),void 0;try{if(!t[n.event])return console.log("Unknown event : "+n.event),void 0;r(i.id),i.onEvent&&i.onEvent.call(null,g)}catch(i){o("Exception in function onEvent()",i)}n.registered=!0,Y.push(n)},p=function(e){for(var e=e||!1,t=0,n=N.length;n>t;t++)e===N[t].getAttribute("data-load-event")&&N[t].classList.add(N[t].id)},v=function(){if(l())return console.log("Already initialized, escaping"),void 0;D=document.getElementsByClassName("lazyload"),N=document.getElementsByClassName("lazyload ondemand");for(var e=0,t=D.length;t>e;e++)D[e].classList.contains("ondemand")||D[e].classList.add(D[e].id);c(!0);var n={event:"start_interaction",message:"First swipe detected.",target:null,time:(new Date).getTime()};f(n)},g=function(e){var t=document.getElementById("video1");return t?q||!1!==(q=E(t))?(q.setPoster(e),!0):!1:!1},m=function(e){var t=document.getElementById(e||"video1");return t?q||!1!==(q=E(t))?(q.togglePause(),!0):!1:!1},E=function(e){try{var t="string"==typeof e?document.getElementById(e):e,n={},i=!1;t.addEventListener("loadedmetadata",function(){this.loadedMetaData=!0},!1),t.addEventListener("error",function(e){logError(e)},!1),t.addEventListener("play",function(){f({event:"video_play"})},!1),t.addEventListener("pause",function(){f({event:"video_stop"})},!1),t.addEventListener("ended",function(){f({event:"video_finished"})},!1),n.element=t,n.play=function(){t.play()},n.pause=function(){t.pause()},n.stop=function(){t.playing&&t.pause()},n.togglePause=function(){t.paused?t.play():t.pause()},n.skip=function(e){t.currentTime+=e},n.reset=function(){i&&(t.currentTime=0)},n.restart=function(){i&&(t.currentTime=0,f({event:"video_restart"}))},n.toggleControls=function(){t.hasAttribute("controls")?this.hideControls():this.showControls()},n.showControls=function(){t.setAttribute("controls","controls")},n.hideControls=function(){t.removeAttribute("controls")},n.setPoster=function(e){t.setAttribute("poster",e)}}catch(o){throw n=null,o}return n};i=function(){function e(e){null==e&&(e=navigator.userAgent),this.source=e.replace(/^\s*/,"").replace(/\s*$/,""),this.browser_name=r(this.source),this.browser_version=a(this.source),this.os=s(this.source),this.platform=c(this.source)}var t,n,i,o,r,a,s,c;return o={Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i},t={Konqueror:/konqueror/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie/i,Opera:/opera/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i},n={WindowsVista:/windows nt 6\.0/i,Windows7:/windows nt 6\.1/i,Windows8:/windows nt 6\.2/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,OSX:/os x (\d+)[._](\d+)/i,Linux:/linux/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Ipad:/\(iPad.*os (\d+)[._](\d+)/i,Iphone:/\(iPhone.*os (\d+)[._](\d+)/i},i={Windows:/windows/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,Ipad:/ipad/i,Ipod:/ipod/i,Iphone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i},r=function(e){switch(!0){case t.Konqueror.test(e):return"konqueror";case t.Chrome.test(e):return"chrome";case t.Safari.test(e):return"safari";case t.IE.test(e):return"ie";case t.Opera.test(e):return"opera";case t.PS3.test(e):return"ps3";case t.PSP.test(e):return"psp";case t.Firefox.test(e):return"firefox";default:return"unknown"}},a=function(e){var t;switch(r(e)){case"chrome":if(o.Chrome.test(e))return RegExp.$1;break;case"safari":if(o.Safari.test(e))return RegExp.$1;break;case"firefox":if(o.Firefox.test(e))return RegExp.$1;break;case"ie":if(o.IE.test(e))return RegExp.$1;break;case"ps3":if(o.Ps3.test(e))return RegExp.$1;break;case"psp":if(o.Psp.test(e))return RegExp.$1;break;default:if(t=/#{name}[\/ ]([\d\w\.\-]+)/i,t.test(e))return RegExp.$1}},s=function(e){switch(!0){case n.WindowsVista.test(e):return"Windows Vista";case n.Windows7.test(e):return"Windows 7";case n.Windows2003.test(e):return"Windows 2003";case n.WindowsXP.test(e):return"Windows XP";case n.Windows2000.test(e):return"Windows 2000";case n.Linux.test(e):return"Linux";case n.Wii.test(e):return"Wii";case n.PS3.test(e):return"Playstation";case n.PSP.test(e):return"Playstation";case n.OSX.test(e):return e.match(n.OSX)[0].replace("_",".");case n.Ipad.test(e):return e.match(n.Ipad)[0].replace("_",".");case n.Iphone.test(e):return e.match(n.Iphone)[0].replace("_",".");default:return"unknown"}},c=function(e){switch(!0){case i.Windows.test(e):return"Microsoft Windows";case i.Mac.test(e):return"Apple Mac";case i.Android.test(e):return"Android";case i.Blackberry.test(e):return"Blackberry";case i.Linux.test(e):return"Linux";case i.Wii.test(e):return"Wii";case i.Playstation.test(e):return"Playstation";case i.Ipad.test(e):return"iPad";case i.Ipod.test(e):return"iPod";case i.Iphone.test(e):return"iPhone";default:return"unknown"}},e}();var h=function(e,t){if(console.log("Faking a click"),t.click)t.click();else if(document.createEvent&&e.target!==t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}},w=function(e){if(V.getBoundingClientRect().left,F.getBoundingClientRect().left,clickpos=Math.abs(e.offsetLeft+P)+e.clientX,M&&K(),R&&U(),clickpos>=4786&&5001>=clickpos){if(e.clientY>25&&125>e.clientY)return}else if(clickpos>=6355&&6570>=clickpos){if(e.clientY>15&&115>e.clientY)return K(),void 0}else if(clickpos>=7760&&7992>=clickpos){if(e.clientY>40&&95>e.clientY)return f({event:"click_link1"}),d(z),void 0;if(e.clientY>100&&155>e.clientY)return f({event:"click_link2"}),d(H),void 0}else if(clickpos>=3178&&3441>=clickpos&&e.clientY>26&&178>e.clientY)return m(),void 0;return!1},y=function(e){w(e)},k=null,_=!1,b=!1,I={},x="none",P=0,S=0,B=100,L=400,W=.9,C=.9,A=.9,M=!1,R=!1,O=60,T=[],Y=[],D=null,N=null,q=null,X=!1,j=document.getElementById("car"),F=document.getElementById("parallax"),V=document.getElementById("layer5"),z=(document.getElementById("debugoutput"),document.getElementById("debuginfo"),document.getElementById("lise_recipe"),document.getElementById("lise_hello"),document.getElementById("farmer_recipe"),document.getElementById("farmer_hello"),document.getElementById("final_btn1"),document.getElementById("final_btn2"),document.getElementById("link1")),H=document.getElementById("link2"),K=function(){M?(f({event:"close_lise"}),$("#lise_tips").animate({top:0,opacity:1},325,"linear"),$("#lise_recipe").animate({top:-300,opacity:0},325,"linear")):(f({event:"click_lise"}),$("#lise_tips").animate({top:300,opacity:0},325,"linear"),$("#lise_recipe").animate({top:0,opacity:1},325,"linear")),M=!M},U=function(){R?(f({event:"click_farmer"}),$("#farmer_tips").animate({top:40,opacity:1},325,"linear"),$("#farmer_recipe").animate({top:-300,opacity:0},325,"linear")):(f({event:"click_farmer"}),$("#farmer_tips").animate({top:300,opacity:0},325,"linear"),$("#farmer_recipe").animate({top:0,opacity:1},325,"linear")),R=!R},G=function(){var e,t=(new Date).getTime(),n=F.getBoundingClientRect();if(b||(_=""+new Date,b=(new Date).getTime(),starttimetext=""+(new Date).getTime()),n){S=P-n.left,S>O&&(l()||(v(),console.log("Interaction detected, preloading resources ..")));var i=0,o=3;for(var r in I)if(!(o>++i)){if(e=P-(I[r].getBoundingClientRect().left-L),0>e)break;if(T[r]||(T[r]=!0),Math.abs(e)>L+250){if(x===r){$("#parallax").parallaxSwipe.setSpeed(W,C,A);var a={event:"leave_"+r,message:"leaving station "+r,target:x,time:t};f(a),x="none"}}else if(x!==r){f({event:"arrive_"+r,message:"arriving at station "+r,target:x,time:t}),x=r;var s=Math.round($("#"+x).position().left);console.log("Requesting position of "+x+" at "+s+", offset: "+$("#"+x).offset().left+", position: "+$("#"+x).position().left+", startpos: "+P),$("#parallax").parallaxSwipe.requestPosition(-s)}}}},J=function(){var e=I.length;P=F.getBoundingClientRect().left,e||($(".station").each(function(e,t){I[t.id||e]=t}),e=I.length),k=setInterval(G,B),r("bounce",8e3,!0,3e3)};$("#parallax").parallaxSwipe({DECAY:C,MOUSEDOWN_DECAY:A,SPEED_SPRING:W,BOUNCE_SPRING:.5,HORIZ:!0,SNAPDISTANCE:20,DISABLELINKS:!1,LAYER:[20,12,3.2,1.6,1,1]});var Z=8e3;$(".parallax_layer").css("width",Z+1e3),$("#parallax").bind("click",function(e){var t={offsetLeft:e.target.offsetLeft,offsetTop:e.target.offsetTop};return"number"==typeof t.offsetLeft&&(t.clientX=e.clientX,t.clientY=e.clientY),y(t),!0}),$(".recipe").bind("selectstart",function(){return!1}),J()})}),requireScript("assets/js/lib/kroma.timetracker.min.js",!1,!1,onSuccess,onError);