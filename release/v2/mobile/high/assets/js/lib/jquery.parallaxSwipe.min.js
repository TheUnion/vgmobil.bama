(function(e){e.fn.parallaxSwipe=function(t){function n(){y(parseInt(o.css(E),10)),1==S&&requestAnimFrame(n)}var i={DECAY:.9,MOUSEDOWN_DECAY:.5,SPEED_SPRING:.5,BOUNCE_SPRING:.08,SNAPDISTANCE:20,DISABLELINKS:!0,LAYER:[]},a=e.extend(i,t),o=this,r=document.getElementById(o.attr("id")),s=o.children(".panel"),c=parseInt(o.parents("div").css("width"),10);parseInt(o.parents("div").css("height"),10);var u,l,d,E,f,h,w=0,m=0,v=!1,p=!1,A=!1,S=!1,g=!0,Y=!1,D=!1,I=0,L=0,R=0,M=0,N=0,_=(new Date).getTime(),b=0,T=!1,C=!0;navigator.userAgent;var O=function(){var e="",t=document.getElementById("debuginfo");L++,b=(new Date).getTime()-_,Math.floor(b/1e3)>N&&(N++,R+=L,I=L,L=0,M=R/(b/1e3)),e+=" ANIM_METHOD: "+T+"<br />",e+="  FRAME_RATE: "+I+"<br />",e+="         FPS: "+Math.round(100*M)/100+"<br />",e+="        TIME: "+N+" sec<br />",t&&(t.innerHTML="<pre>"+e+"</pre>")},P=parseInt(s.css("width"),10)*s.length;h=c,E="left",s.css("float","left"),o.css("width",P),f=P,o.css(E,0),this.parallaxSwipe.getSize=function(){return P>""?P:sliderH};var y=function(t){var n="";if(D)return w=.5*(D-t),t=Math.round(t+w),4>=Math.abs(w)&&(t=Math.round(D),w=0,console.log("We have reached position "+D),D=!1),o.css(E,t),a.LAYER.length>0&&e.each(a.LAYER,function(n,i){e("#layer"+(n+1)).css(E,t/i)}),void 0;if(w*=v&&!D&&t>-7650?a.MOUSEDOWN_DECAY:a.DECAY,!v){if(t>0-w)return t=0,o.css(E,t),a.LAYER.length>0&&e.each(a.LAYER,function(n){e("#layer"+(n+1)).css(E,t)}),void 0;if(-7650>t+f?(t=-7650,w=0,m=(h-f-t)*a.BOUNCE_SPRING):m=0,0>d-l){var i=Math.round(w+m),r=t+i;o.css(E,r),a.LAYER.length>0&&e.each(a.LAYER,function(t,n){e("#layer"+(t+1)).css(E,r/n)})}else{var i=Math.round(w+m);o.css(E,t+i),a.LAYER.length>0&&e.each(a.LAYER,function(n,a){e("#layer"+(n+1)).css(E,(t+i)/a)})}n+="sliderLT is "+t+"<br />_velocity is "+w+"<br />REQUESTED_POSITION is "+D+"<br />bounce is "+m,e("#position_data").html(n),O()}};window.requestAnimFrame=function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};return C&&(T=e.name||e),e}();var F=function(){e("a",o).each(function(){e(this).click(function(){return Math.abs(d-l)>=a.SNAPDISTANCE?!1:void 0})})},q=function(e){D||v||(A?e=event.touches[0]:e||(e=window.event),r.setCapture?r.setCapture():(window.addEventListener("mousemove",X,!1),window.addEventListener("mouseup",x,!1)),l=d=1==p?e.clientX:e.pageX,u=document.getElementById(o.attr("id")).offsetLeft,_verticalXY=_lastVerticalDownXY=1==p?e.clientY:e.pageY,_verticalLT=document.getElementById(o.attr("id")).offsetTop,0==u?g=!0:-7650>=u?(-7650>u&&(w=-.3),Y=!0):(g=!1,Y=!1),v=!0,0==S&&(S=!0,requestAnimFrame(n)))};this.parallaxSwipe.stop=function(){w=0},this.parallaxSwipe.setSpeed=function(e,t,n){return a.DECAY=t,a.MOUSEDOWN_DECAY=n,a},this.parallaxSwipe.requestPosition=function(e){D=Math.round(e),console.log("REQUESTED_POSITION: "+D)},this.parallaxSwipe.setEdge=function(e){switch(e.toLowerCase()){case"right":Y=!0;break;case"left":g=!0}};var X=function(t){var n=t;if(!D&&v){if(A?n=event.touches[0]:n||(n=window.event),1==p)var i=n.clientX,r=n.clientY;else var i=n.pageX,r=n.pageY;var s=i-d,c=r-_lastVerticalDownXY;if(B(s,c)){t.preventDefault();var f=u+(i-l);g&&f>0||f>0?Y=!1:Y&&-7650>f||-7650>f?(console.log("consoleVar: "+f+", deltaX: "+s),g=!1):(i-l>7650&&(i-=7650-(i-l)),o.css(E,u+(i-l)),a.LAYER.length>0&&e.each(a.LAYER,function(t,n){e("#layer"+(t+1)).css(E,(u+(i-l))/n)}),w+=(i-d)*a.SPEED_SPRING,d=i)}else t.stopPropagation()}},x=function(){v&&(v=!1,F(),r.setCapture?r.releaseCapture():(window.removeEventListener("mousemove",X,!1),window.removeEventListener("mouseup",x,!1)))},B=function(e,t){var n;return n=0==t?!0:.37>=e/t&&e/t>=-.37?!1:!0};A="ontouchstart"in window,o.bind("mousedown touchstart",function(e){q(e)}),o.bind("mousemove touchmove",function(e){X(e)}),o.bind("mouseup touchend",function(e){x(e)})}})(jQuery);