$(document).ready(function(){$(document).bind("dragstart",function(){return!1});var e=!1,t=null;$(function(){window.onerror=n;var n=function(e){var t=e.message;for(var n in e)t+=n+" : "+e[n]+"\n";alert(t)},i=function(e,t,n,a){var e=e||"bounce",t=t||5e3,n=n||!1,a=a||!1;r()||(o(e,n,a),n&&setTimeout(i,t,e,t,n,a))},a=function(e){var e=e||!1;e&&car.classList.remove(e)},o=function(e,t,n){var e=e||"bounce",n=n||!1;car.classList.add(e),n&&setTimeout(a,n,e)},l=function(){e=!0},r=function(){return e},c=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},s=function(e){c()?(console.log("Opening link the android way: "+e.href),window.open(e.href)):(console.log("Opening link the fake-click way: "+e.href),E(null,e))},d=function(e){f(e.event);try{0===e.event.indexOf("start_interaction")&&p62602Event(6260200),0===e.event.indexOf("arrive_station3")&&p62602Event(6260201),0===e.event.indexOf("arrive_station4")&&(v("assets/img/poster.jpg"),p62602Event(6260202)),0===e.event.indexOf("arrive_station6")&&p62602Event(6260203),0===e.event.indexOf("arrive_station7")&&p62602Event(6260204),0===e.event.indexOf("leave_station3")&&p62602Event(6260205),0===e.event.indexOf("leave_station4")&&p62602Event(6260206),0===e.event.indexOf("leave_station6")&&(g(),p62602Event(6260207)),0===e.event.indexOf("leave_station7")&&p62602Event(6260208),0===e.event.indexOf("click_lise")&&p62602Event(6260209),0===e.event.indexOf("click_farmer")&&p62602Event(6260210),0===e.event.indexOf("click_link1")&&(console.log("Opening link1"),p62602Event(6260211)),0===e.event.indexOf("click_link2")&&(console.log("Opening link2"),p62602Event(6260212)),0===e.event.indexOf("close_lise")&&p62602Event(6260213),0===e.event.indexOf("close_farmer")&&p62602Event(6260214),(0===e.event.indexOf("video_play")||0===e.event.indexOf("video_resume"))&&p62602Event(6260215),0===e.event.indexOf("video_pause")&&p62602Event(6260216),0===e.event.indexOf("event_idle")&&p62602Event(6260217),0===e.event.indexOf("event_wake")&&p62602Event(6260218),0===e.event.indexOf("video_finish")&&p62602Event(6260220)}catch(t){n(t)}T.push(e),console.log("Event triggered: "+e.event)},f=function(e){for(var e=e||!1,t=0,n=ONDEMAND_LOADERS.length;n>t;t++)e===ONDEMAND_LOADERS[t].getAttribute("data-load-event")&&ONDEMAND_LOADERS[t].classList.add(ONDEMAND_LOADERS[t].id)},u=function(){if(r())return console.log("Already initialized, escaping"),void 0;M=document.getElementsByClassName("lazyload"),ONDEMAND_LOADERS=document.getElementsByClassName("lazyload ondemand");for(var e=0,t=M.length;t>e;e++)M[e].classList.contains("ondemand")||M[e].classList.add(M[e].id);l(!0);var n={event:"start_interaction",message:"First swipe detected.",target:null,time:(new Date).getTime()};d(n)},v=function(e){var n=document.getElementById("video1");return n?t||!1!==(t=m(n))?(t.setPoster(e),!0):!1:!1},p=function(e){var n=document.getElementById(e||"video1");return n?t||!1!==(t=m(n))?(t.togglePause(),!0):!1:!1},g=function(e){var n=document.getElementById(e||"video1");return n?t||!1!==(t=m(n))?(t.pause(),!0):!1:!1},m=function(e){try{var t="string"==typeof e?document.getElementById(e):e,i={},a=!1;t.addEventListener("loadedmetadata",function(){this.loadedMetaData=!0},!1),t.addEventListener("error",function(e){n(e)},!1),t.addEventListener("play",function(){d({event:"video_play"})},!1),t.addEventListener("pause",function(){d({event:"video_pause"})},!1),t.addEventListener("ended",function(){d({event:"video_finish"})},!1),i.element=t,i.play=function(){t.play()},i.pause=function(){t.pause()},i.stop=function(){t.playing&&t.pause()},i.togglePause=function(){t.paused?t.play():t.pause()},i.skip=function(e){t.currentTime+=e},i.reset=function(){a&&(t.currentTime=0)},i.restart=function(){a&&(t.currentTime=0,d({event:"video_restart"}))},i.toggleControls=function(){t.hasAttribute("controls")?this.hideControls():this.showControls()},i.showControls=function(){t.setAttribute("controls","controls")},i.hideControls=function(){t.removeAttribute("controls")},i.setPoster=function(e){t.setAttribute("poster",e)}}catch(o){throw i=null,o}return i},E=function(e,t){if(console.log("Faking a click"),t.click)t.click();else if(document.createEvent&&e.target!==t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}},_=function(e){if(scene.getBoundingClientRect().left,parallax.getBoundingClientRect().left,clickpos=Math.abs(e.offsetLeft+B)+e.clientX,S&&P(),C&&z(),clickpos>=4866&&4991>=clickpos){if(e.clientY>230&&275>e.clientY)return z(),void 0}else if(clickpos>=6380&&6505>=clickpos){if(e.clientY>240&&285>e.clientY)return P(),void 0}else if(clickpos>=11111&&11325>=clickpos){if(e.clientY>208&&272>e.clientY)return s(link1),d({event:"click_link1"}),void 0;if(e.clientY>276&&348>e.clientY)return s(link2),d({event:"click_link2"}),void 0}else if(clickpos>=9292&&9708>=clickpos&&e.clientY>86&&302>e.clientY)return console.log("click on video: "+link2.href),p(),void 0;return!1},y=function(e){_(e)},k=null,O=!1,x=!1,h={},D="none",B=0,w=0,I=100,A=416,L=.9,b=.9,N=.9,S=!1,C=!1,R=60,Y=[],T=[],M=null;ONDEMAND_LOADERS=null,t=null,CLICK_ENABLED=!1,car=document.getElementById("car"),debugpanel=document.getElementById("debugoutput"),parallax=document.getElementById("parallax"),scene=document.getElementById("layer5"),debugtrigger=document.getElementById("debug_trigger"),debuginfo=document.getElementById("debug_info"),lise_recipe=document.getElementById("lise_recipe"),lise_hello=document.getElementById("lise_hello"),farmer_recipe=document.getElementById("farmer_recipe"),farmer_hello=document.getElementById("farmer_hello"),final_btn1=document.getElementById("final_btn1"),final_btn2=document.getElementById("final_btn2"),link1=document.getElementById("link1"),link2=document.getElementById("link2"),clicktargets={},document.getElementsByClassName("clicktarget");var P=function(){S?(d({event:"close_lise"}),$("#lise_tips").animate({top:40,opacity:1},325,"linear"),$("#lise_recipe").animate({top:-500,opacity:0},325,"linear")):(d({event:"click_lise"}),$("#lise_tips").animate({top:500,opacity:0},325,"linear"),$("#lise_recipe").animate({top:0,opacity:1},325,"linear")),S=!S},z=function(){C?(d({event:"close_farmer"}),$("#farmer_tips").animate({top:40,opacity:1},325,"linear"),$("#farmer_recipe").animate({top:-500,opacity:0},325,"linear")):(d({event:"click_farmer"}),$("#farmer_tips").animate({top:500,opacity:0},325,"linear"),$("#farmer_recipe").animate({top:0,opacity:1},325,"linear")),C=!C},q=function(){var e,t=(new Date).getTime(),n=parallax.getBoundingClientRect();if(x||(O=""+new Date,x=(new Date).getTime(),starttimetext=""+(new Date).getTime()),n){w=B-n.left,w>R&&(r()||(u(),console.log("Interaction detected, preloading initiated"))),-10924>w&&$("#parallax").parallaxSwipe.requestPosition(-10924);var i=0,a=3;for(var o in h)if(!(a>++i)){if(e=B-(h[o].getBoundingClientRect().left-A),0>e)break;if(Y[o]||(Y[o]=!0),Math.abs(e)>A){if(D===o){$("#parallax").parallaxSwipe.setSpeed(L,b,N);var l={event:"leave_"+o,message:"leaving station "+o,target:D,time:t};d(l),D="none"}}else if(D!==o){if(d({event:"arrive_"+o,message:"arriving at station "+o,target:D,time:t}),D=o,5===i)continue;var c=Math.round($("#"+D).position().left);console.log("Requesting position of "+D+" at "+c+", offset: "+$("#"+D).offset().left+", position: "+$("#"+D).position().left+", startpos: "+B),$("#parallax").parallaxSwipe.requestPosition(-c)}}}},X=function(){var e=h.length;B=parallax.getBoundingClientRect().left,e||($(".station").each(function(e,t){h[t.id||e]=t}),e=h.length),k=setInterval(q,I),i("bounce",8e3,!0,3e3)};setTimeout(function(){window.scrollTo(0,1)},0),$("#parallax").parallaxSwipe({DECAY:b,MOUSEDOWN_DECAY:N,SPEED_SPRING:L,BOUNCE_SPRING:.1,HORIZ:!0,SNAPDISTANCE:20,DISABLELINKS:!1,LAYER:[20,20,3.2,1.6,1,.9]});var F=$("#parallax").parallaxSwipe.getSize();$(".parallax_layer").css("width",F),$("#parallax").bind("click",function(e){var t={offsetLeft:e.target.offsetLeft,offsetTop:e.target.offsetTop};return"number"==typeof t.offsetLeft&&(t.clientX=e.clientX,t.clientY=e.clientY),y(t),!0}),$(".recipe").bind("selectstart",function(){return!0}),X()})});